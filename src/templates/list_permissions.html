{% extends 'base.html' %}
{% block head %}
	<!--Regular Datatables CSS-->
	<link href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css" rel="stylesheet">
	<!--Responsive Extension Datatables CSS-->
	<link href="https://cdn.datatables.net/responsive/2.2.3/css/responsive.dataTables.min.css" rel="stylesheet">

	<style>
		/*Overrides for Tailwind CSS */

		/*Form fields*/
		.dataTables_wrapper select,
		.dataTables_wrapper .dataTables_filter input {
			color: #4a5568;
			/*text-gray-700*/
			padding-left: 1rem;
			/*pl-4*/
			padding-right: 1rem;
			/*pl-4*/
			padding-top: .5rem;
			/*pl-2*/
			padding-bottom: .5rem;
			/*pl-2*/
			line-height: 1.25;
			/*leading-tight*/
			border-width: 2px;
			/*border-2*/
			border-radius: .25rem;
			border-color: #edf2f7;
			/*border-gray-200*/
			background-color: #edf2f7;
			/*bg-gray-200*/
		}

		/*Row Hover*/
		table.dataTable.hover tbody tr:hover,
		table.dataTable.display tbody tr:hover {
			background-color: #ebf4ff;
			/*bg-indigo-100*/
		}

		/*Pagination Buttons*/
		.dataTables_wrapper .dataTables_paginate .paginate_button {
			font-weight: 700;
			/*font-bold*/
			border-radius: .25rem;
			/*rounded*/
			border: 1px solid transparent;
			/*border border-transparent*/
		}

		/*Pagination Buttons - Current selected */
		.dataTables_wrapper .dataTables_paginate .paginate_button.current {
			color: #fff !important;
			/*text-white*/
			box-shadow: 0 1px 3px 0 rgba(0, 0, 0, .1), 0 1px 2px 0 rgba(0, 0, 0, .06);
			/*shadow*/
			font-weight: 700;
			/*font-bold*/
			border-radius: .25rem;
			/*rounded*/
			background: #667eea !important;
			/*bg-indigo-500*/
			border: 1px solid transparent;
			/*border border-transparent*/
		}

		/*Pagination Buttons - Hover */
		.dataTables_wrapper .dataTables_paginate .paginate_button:hover {
			color: #fff !important;
			/*text-white*/
			box-shadow: 0 1px 3px 0 rgba(0, 0, 0, .1), 0 1px 2px 0 rgba(0, 0, 0, .06);
			/*shadow*/
			font-weight: 700;
			/*font-bold*/
			border-radius: .25rem;
			/*rounded*/
			background: #667eea !important;
			/*bg-indigo-500*/
			border: 1px solid transparent;
			/*border border-transparent*/
		}

		/*Add padding to bottom border */
		table.dataTable.no-footer {
			border-bottom: 1px solid #e2e8f0;
			/*border-b-1 border-gray-300*/
			margin-top: 0.75em;
			margin-bottom: 0.75em;
		}

		/*Change colour of responsive icon*/
		table.dataTable.dtr-inline.collapsed>tbody>tr>td:first-child:before,
		table.dataTable.dtr-inline.collapsed>tbody>tr>th:first-child:before {
			background-color: #667eea !important;
			/*bg-indigo-500*/
		}
		/* Estilos personalizados para las celdas td del DataTables */
		#tablaPermisos.dataTable td {
            text-align: center; /* Alineación del texto */
        }
	</style>
{% endblock %}

{% block content %}
	<!--Container-->
	<div class="container w-full md:w-4/5 xl:w-4/5  mx-auto px-5">
		<!--Card-->
		<div id='recipients' class="p-3 mt-6 lg:mt-0 rounded shadow bg-white">
			<table id="tablaPermisos" class="stripe hover text-sm" style="width:100%; padding-top: 1em;  padding-bottom: 1em;">
				<thead>
					<tr>
						<th data-priority="1">ID</th>
						<th data-priority="2">Fecha</th>
						<th data-priority="3">Solicitante</th>
						<th data-priority="4">Hora Salida</th>
						<th data-priority="5">Hora Retorno</th>
						<th data-priority="6" style="min-width: 300px;">Motivo</th>
                        <th data-priority="8">Estado</th>
                        <th data-priority="9">Opciones</th>
					</tr>
				</thead>
				<tbody>
				</tbody>
				<!--<tbody>
					{% for permission in permissions %}
					<tr>
						<td>{{permission.id}}</td>
						<td>{{permission.permission_date}}</td>
						<td>{{permission.dni}}</td>
						<td>{{permission.start_time}}</td>
						<td>{{permission.end_time}}</td>
						<td>{{permission.reason}}</td>
						<td>{{permission.status}} <span id="aceptaSpan" class="px-2 py-1 text-white rounded">

						</span> </td>
						<td> < | X</td>
					</tr>
					{% endfor %}
				</tbody>
					-->

			</table>

            <!-- INIT Modal -->
			<button class="btn" onclick="my_modal_1.showModal()">open modal</button>
			<div id="my_modal_1" class="relative z-10 modal" aria-labelledby="modal-title" role="dialog" aria-modal="true">
				<!--
				  Background backdrop, show/hide based on modal state.
				  Entering: "ease-out duration-300"
					From: "opacity-0"
					To: "opacity-100"
				  Leaving: "ease-in duration-200"
					From: "opacity-100"
					To: "opacity-0"
				-->
				<div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"></div>

				<div class="fixed inset-0 z-10 w-screen overflow-y-auto">
				  <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
					<!--
					  Modal panel, show/hide based on modal state.
					  Entering: "ease-out duration-300"
						From: "opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
						To: "opacity-100 translate-y-0 sm:scale-100"
					  Leaving: "ease-in duration-200"
						From: "opacity-100 translate-y-0 sm:scale-100"
						To: "opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
					-->
					<div class="relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg">
					  <div class="bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4">
						<div class="sm:flex sm:items-start">
						  <div class="mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10">
							<svg class="h-6 w-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
							  <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
							</svg>
						  </div>
						  <div class="mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left">
							<h3 class="text-base font-semibold leading-6 text-gray-900" id="modal-title">Deactivate account</h3>
							<div class="mt-2">
							  <p class="text-sm text-gray-500">Are you sure you want to deactivate your account? All of your data will be permanently removed. This action cannot be undone.</p>
							</div>
						  </div>
						</div>
					  </div>
					  <div class="bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6">
						<button type="button" class="inline-flex w-full justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 sm:ml-3 sm:w-auto">Deactivate</button>
						<button type="button" class="mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto">Cancel</button>
					  </div>
					</div>
				  </div>
				</div>
			  </div>
          <!-- END Modal -->
		</div>
	</div>
	<!--/container-->
	<script>
	</script>
{% endblock %}
{% block script %}
<!--Datatables -->
<script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/responsive/2.2.3/js/dataTables.responsive.min.js"></script>
<script>
	// Accede a los datos de Flask pasados a la plantilla HTML utilizando Jinja2
	var permissions = {{ permissions|tojson|safe }};
	console.log('permissions', permissions)
	$(document).ready(function() {
		var tablaPermisos = $('#tablaPermisos').DataTable({
			responsive: true,
			"order": [[ 0, "desc" ]]
		})
		  .columns.adjust()
		  .responsive.recalc();

		  // Agregar las filas a la tabla DataTables
		  permissions.forEach(function(permission) {
			tablaPermisos.row.add([
				permission.id,
				permission.permission_date,
				permission.dni,
				permission.start_time,
				permission.end_time,
				permission.reason,
				renderRowStatus(permission.status),
				renderRowOptions(permission.id)
			]).draw();
		});
	});

	function renderRowStatus(status){
		const colorStatus = {
			'PENDIENTE': 'bg-gray-400',
			'ACEPTADO': 'bg-emerald-500',
			'RECHAZADO': 'bg-red-400',
			'EXTENDIDO': 'bg-yellow-500'
		}
		return `<span class='text-xs px-2 py-1 text-white rounded ${colorStatus[status]}'>${status}</span>`
	}
	function renderRowOptions(id){
		return `
        <div class="flex justify-evenly gap-2">
            <button onclick="aceptar(${id})" class="bg-blue-0 text-white py-1"">
                <svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 512 512">
                    <path
                        d="M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-111 111-47-47c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64c9.4 9.4 24.6 9.4 33.9 0L369 209z" />
                </svg>
				<!--
				<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 25 25" fill="none"
                    stroke="#667eea" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M2.5 2v6h6M21.5 22v-6h-6" />
                    <path d="M22 11.5A10 10 0 0 0 3.2 7.2M2 12.5a10 10 0 0 0 18.8 4.2" />
                </svg>
				-->
            </button>
			<button onclick="rechazar(${id})" class="bg-red-0 text-white py-1">
                <svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 512 512">
                    <path
                        d="M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM175 175c-9.4 9.4-9.4 24.6 0 33.9l47 47-47 47c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l47-47 47 47c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-47-47 47-47c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-47 47-47-47c-9.4-9.4-24.6-9.4-33.9 0z" />
                </svg>
            </button>
            <button onclick="eliminar(${id})" class="bg-red-0 text-white py-1">
                <svg xmlns="http://www.w3.org/2000/svg" height="19" width="16" viewBox="0 0 448 512">
                    <path
                        d="M268 416h24a12 12 0 0 0 12-12V188a12 12 0 0 0 -12-12h-24a12 12 0 0 0 -12 12v216a12 12 0 0 0 12 12zM432 80h-82.4l-34-56.7A48 48 0 0 0 274.4 0H173.6a48 48 0 0 0 -41.2 23.3L98.4 80H16A16 16 0 0 0 0 96v16a16 16 0 0 0 16 16h16v336a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128h16a16 16 0 0 0 16-16V96a16 16 0 0 0 -16-16zM171.8 50.9A6 6 0 0 1 177 48h94a6 6 0 0 1 5.2 2.9L293.6 80H154.4zM368 464H80V128h288zm-212-48h24a12 12 0 0 0 12-12V188a12 12 0 0 0 -12-12h-24a12 12 0 0 0 -12 12v216a12 12 0 0 0 12 12z" />
                </svg>
            </button>
			<button onclick="extender(${id})" class="bg-red-0 text-white py-1">
                <svg height="25" width="25" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path d="M9 12H15" stroke="#323232" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M12 9L12 15" stroke="#323232" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="#323232" stroke-width="2"/>
				</svg>
            </button>
        </div>
		`
	}

	function aceptar(id) {
		// Lógica para aceptar el elemento con el ID proporcionado
		console.log("aceptar ID:", id);
	}

    function rechazar(id) {
		// Lógica para rechazar el elemento con el ID proporcionado
		console.log("rechazar ID:", id);
	}

	function eliminar(id) {
		// Lógica para eliminar el elemento con el ID proporcionado
		console.log("Eliminar ID:", id);
	}

	function extender(id) {
		// Lógica para Extender el elemento con el ID proporcionado
		console.log("Extender ID:", id);
	}

</script>
{% endblock %}